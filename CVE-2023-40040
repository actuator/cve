CVE-2023-40040

NOTE: The following issue is only applicable to Android versions that
> lack runtime permission checks, and of those only Android SDK 5.1.1 API 22 is consistent with the manifest.
> Thus, this applies to Android Lollipop only as earlier versions aren't supported & thus effects less than five
> percent of Android devices as of 2023. 

-------------------------------------------
Description:
> An issue was discovered in the MyCrops HiGrade "THC Testing & Cannabi" application 1.0.337 for Android.
> A remote attacker can start the camera feed
> via the com.cordovaplugincamerapreview.CameraActivity
> component in a context-specific capacity. 
>
> ------------------------------------------
>
> [VulnerabilityType Other]
> CWE-926: Improper Export of Android Application Components
>
> ------------------------------------------
>
> [Vendor of Product]
> MyCrops Technologies Ltd.
>
> ------------------------------------------
>
> [Affected Product Code Base]
> HiGrade: THC Testing & Cannabi - Version: 1.0.337 & users running Android SDK 5.1.1 API 22 Lollipop & Earlier
>
> ------------------------------------------
>
> [Affected Component]
> The exported activity 'com.cordovaplugincamerapreview.CameraActivity' of application 'com.phonegap.higrade'
> The applications has manifest entry:'<uses-sdk android:minSdkVersion="22" android:targetSdkVersion="31"/>'
>
> ------------------------------------------
>
> [Attack Type]
> Context-dependent
>
> ------------------------------------------
>
> [Impact Information Disclosure]
> true
>
> ------------------------------------------
>
> [Attack Vectors]
> This issue is specifically applicable to devices running Android SDK 22, a supported SDK for the app whose SDK version 23 predated runtime permission checks.
> Malicious apps targeting SDK 22 can exploit this vulnerability to gain unauthorized access to the activity and potentially capture sensitive user information.
> Here is an example code snippet demonstrating intent-based invocation of the exported activity missing pertinent permission checks:

> [JAVA]
> Intent intent = new Intent();
> intent.setComponent(new ComponentName("com.phonegap.higrade", "com.cordovaplugincamerapreview.CameraActivity"));
> startActivity(intent);
> [/JAVA]
>
> ------------------------------------------
>
> [Reference]
>
https://github.com/actuator/cve/blob/main/com.cordovaplugincamerapreview.CameraActivity.png
>
> ------------------------------------------
>
> [Has vendor confirmed or acknowledged the vulnerability?]
> true
>
> ------------------------------------------
>
> [Discoverer]
> Edward Warren
