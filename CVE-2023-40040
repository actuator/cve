CVE-2023-40040

> An issue was discovered on the MyCrops HiGrade "THC Testing & Cannabi" application 1.0.337 for Android.
> A remote attacker can access the camera feed
> via the com.cordovaplugincamerapreview.CameraActivity
> component in some situations. NOTE: this is only exploitable on Android versions that
> lack runtime permission checks, and of those only Android SDK 5.1.1 API 22 is consistent with the manifest.
> Thus, this applies to Android Lollipop and possibly earlier, affecting less than five
> percent of Android devices as of 2023.
>
> ------------------------------------------
>
> [VulnerabilityType Other]
> CWE-926: Improper Export of Android Application Components
>
> ------------------------------------------
>
> [Vendor of Product]
> MyCrops Technologies Ltd.
>
> ------------------------------------------
>
> [Affected Product Code Base]
> HiGrade: THC Testing & Cannabi - Version: 1.0.337 & users running Android SDK 5.1.1 API 22 Lollipop & Earlier
>
> ------------------------------------------
>
> [Affected Component]
> The exported activity  'com.cordovaplugincamerapreview.CameraActivity' of application 'com.phonegap.higrade'
> The applications has manifest entry: '<uses-sdk android:minSdkVersion="22" android:targetSdkVersion="31"/>'
>
> ------------------------------------------
>
> [Attack Type]
> Context-dependent
>
> ------------------------------------------
>
> [Impact Information Disclosure]
> true
>
> ------------------------------------------
>
> [Attack Vectors]
> This issue is specifically applicable to devices running Android SDK 22, a supported SDK for the app whose SDK version 23 predated runtime permission checks.
> Malicious apps targeting SDK 22 can exploit this vulnerability to gain unauthorized access to the activity and potentially capture sensitive user information without the users knowledge or consent.
> Here is an example code snippet demonstrating the invocation of the exported activity without the necessary permission checks:
> {JAVA]
> Intent intent = new Intent();
> intent.setComponent(new ComponentName("com.phonegap.higrade", "com.cordovaplugincamerapreview.CameraActivity"));
> startActivity(intent);
> [/JAVA]
>
> ------------------------------------------
>
> [Reference]
> https://github.com/actuator/higrade
>
> ------------------------------------------
>
> [Has vendor confirmed or acknowledged the vulnerability?]
> true
>
> ------------------------------------------
>
> [Discoverer]
> Edward Warren
