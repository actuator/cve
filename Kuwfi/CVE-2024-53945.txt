The KuWFi 4G AC900 LTE router 1.0.13 is vulnerable to command injection on the HTTP API endpoints /goform/formMultiApnSetting and /goform/atCmd. An authenticated attacker can execute arbitrary OS commands with root privileges via shell metacharacters in parameters such as pincode and cmds. Exploitation can lead to full system compromise, including enabling remote access (e.g., enabling telnet).
> ------------------------------------------
>
> [Vulnerability Type Other]
> CWE-94: Improper Control of Generation of Code ('Code Injection')
>
> ------------------------------------------
>
> [Vendor of Product]
> KuWFi
>
> ------------------------------------------
>
> [Affected Product Code Base]
> "KuWFi 4G LTE Router" Model AC900 - Firmware Version: V1.0.13
>
> ------------------------------------------
>
> [Affected Component]
> Endpoints:
> /goform/formMultiApnSetting
> /goform/atCmd
>
> ------------------------------------------
>
> [Attack Type]
> Remote
>
> ------------------------------------------
>
> [Impact Code execution]
> true
>
> ------------------------------------------
>
> [Impact Denial of Service]
> true
>
> ------------------------------------------
>
> [Impact Escalation of Privileges]
> true
>
> ------------------------------------------
>
> [Impact Information Disclosure]
> true
>
> ------------------------------------------
>
> [Attack Vectors]
> This vulnerability can be exploited by sending a specially crafted POST request to the affected endpoints. For instance:
> In /goform/formMultiApnSetting, injecting pincode=$(telnetd) enables telnet on the device.
> In /goform/atCmd, injecting cmds=$(pwd) executes arbitrary OS shell commands.
> Improper input validation on parameters (pincode and cmds) allows the execution of arbitrary system commands with root privileges,
>
> ------------------------------------------
>
> [Reference]
> https://kuwfi.com/products/kuwfi-gigabit-wireless-router-4g-lte-wifi-router-dual-band-portable-wifi-modem-hotspot-64-user-with-gigabit-wan-lan-rj11-port
> https://github.com/actuator/cve/tree/main/Kuwfi
>
> ------------------------------------------
>
> [Discoverer]
> Edward Warren