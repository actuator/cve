An issue was discovered on KuWFi GC111 devices (Hardware Version: CPE-LM321_V3.2, Software Version: GC111-GL-LM321_V3.0_20191211). They are vulnerable to unauthenticated /goform/goform_set_cmd_process requests. A crafted POST request, using the SSID parameter, allows remote attackers to execute arbitrary OS commands with root privileges.
> ------------------------------------------
> [VulnerabilityType Other]
> CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
>
> ------------------------------------------
>
> [Vendor of Product]
> KuWFi
>
> ------------------------------------------
>
> [Affected Product Code Base]
> Model: GC111 - Hardware Version: CPE-LM321_V3.2, Software Version: GC111-GL-LM321_V3.0_20191211
>
> ------------------------------------------
>
> [Affected Component]
> POST /goform/goform_set_cmd_process: Improper input validation allows command injection through the ssid parameter.
>
> ------------------------------------------
>
> [Attack Type]
> Remote
>
> ------------------------------------------
>
> [Impact Code execution]
> true
>
> ------------------------------------------
>
> [Impact Denial of Service]
> true
>
> ------------------------------------------
>
> [Impact Escalation of Privileges]
> true
>
> ------------------------------------------
>
> [Impact Information Disclosure]
> true
>
> ------------------------------------------
>
> [Attack Vectors]
> Attackers can exploit this vulnerability by sending a crafted POST request to the /goform/goform_set_cmd_process endpoint with malicious payloads injected into the ssid parameter.
> For example, by including $(touch CMDPoc) in the ssid field, arbitrary commands are executed on the device's underlying operating system with root privileges.
> This vulnerability can be exploited remotely and without authentication, providing attackers with the ability to execute arbitrary commands on the device.
>
> ------------------------------------------
>
> [Reference]
> https://www.kuwfi.com/products/300mbps-industrial-router-cat4-4g-cpe-router-extender-strong-wifi-signal-suport-32wifi-users-with-sim-card-slot-95
> https://github.com/actuator/cve/tree/main/kuwfi
>
> ------------------------------------------
>
> [Discoverer]
> Edward Warren
