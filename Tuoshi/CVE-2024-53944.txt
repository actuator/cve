An issue was discovered on Tuoshi/Dionlink LT15D 4G Wi-Fi devices through M7628NNxlSPv2xUI_v1.0.1802.10.08_P4 and LT21B devices through M7628xUSAxUIv2_v1.0.1481.15.02_P0.
A unauthenticated remote attacker with network access can exploit a command injection vulnerability. The /goform/formJsonAjaxReq endpoint fails to sanitize shell metacharacters sent via JSON parameters, thus allowing attackers to execute arbitrary OS commands with root privileges.
>
> ------------------------------------------
>
> [VulnerabilityType Other]
> CWE-94: Improper Control of Generation of Code ('Code Injection')
>
> ------------------------------------------
>
> [Vendor of Product]
> Shenzhen Tuoshi Network Communications Co.,Ltd / Dionlink
>
> ------------------------------------------
>
> [Affected Product Code Base]
> AKA "Dionlink" 4G LTE CPE Wireless Router - Confirmed: Firmware Ver: M7628NNxlSPv2xUI_v1.0.1802.10.08_P4  &  Firmware Version: M7628xUSAxUIv2_v1.0.1481.15.02_P0
>
> ------------------------------------------
>
> [Affected Component]
> Endpoint: /goform/formJsonAjaxReq
>
> ------------------------------------------
>
> [Attack Type]
> Remote
>
> ------------------------------------------
>
> [Impact Code execution]
> true
>
> ------------------------------------------
>
> [Impact Denial of Service]
> true
>
> ------------------------------------------
>
> [Impact Escalation of Privileges]
> true
>
> ------------------------------------------
>
> [Impact Information Disclosure]
> true
>
> ------------------------------------------
>
> [Attack Vectors]
> An attacker does not need to be authenticated to exploit this vulnerability. With only network access to the Tuoshi / Dionlink 4G Wireless WiFi Router, the attacker can send a maliciously crafted HTTP POST request to the /goform/formJsonAjaxReq endpoint. The payload includes command injection in JSON parameters including check_ip1 & check_ip2, allowing arbitrary commands to be executed directly on the device. Numerous other parameters on endpoint '/goform/formJsonAjaxReq' are also vulnerable.
>
> ------------------------------------------
>
> [Reference]
> http://www.tuoshi.net/productview.asp?id=218
> http://www.tuoshi.net/productview.asp?id=226
> https://github.com/actuator/cve/tree/main/Tuoshi/CVE-2024-53944-Whitepaper.pdf
> https://github.com/actuator/cve/tree/main/Tuoshi/Firmware-M7628NNxISPv2xUI_v1.0.1802.10.08_P4-Blind-CMD-Injection-unauth-WAN.gif
> ------------------------------------------
>
> [Has vendor confirmed or acknowledged the vulnerability?]
> true
>
> ------------------------------------------
>
> [Discoverer]
> Edward Warren