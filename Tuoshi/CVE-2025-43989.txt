The /goform/formJsonAjaxReq POST endpoint of Shenzhen Tuoshi NR500-EA RG500UEAABxCOMSLICv3.4.2731.16.43 devices mishandles the set_timesetting action with the ntpserver0 parameter, which is used in a system command. By setting a username=admin cookie (bypassing normal session checks), an unauthenticated attacker can use that parameter to execute arbitrary OS commands.

>
> ------------------------------------------
>
> [Vulnerability Type Other]
> CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
>
> ------------------------------------------
>
> [Vendor of Product]
> Shenzhen Tuoshi Network Communications Co.,Ltd
>
> ------------------------------------------
>
> [Affected Product Code Base]
> Model NR500-EA - Firmware version RG500UEAABxCOMSLICv3.4.2731.16.43
>
> ------------------------------------------
>
> [Affected Component]
> HTTP POST endpoint /goform/formJsonAjaxReq
>
> ------------------------------------------
>
> [Attack Type]
> Remote
>
> ------------------------------------------
>
> [Impact Code execution]
> true
>
> ------------------------------------------
>
> [Impact Denial of Service]
> true
>
> ------------------------------------------
>
> [Impact Escalation of Privileges]
> true
>
> ------------------------------------------
>
> [Impact Information Disclosure]
> true
>
> ------------------------------------------
>
> [Attack Vectors]
> This vulnerability allows unauthenticated attackers to execute arbitrary OS commands due to improper session validation. A crafted payload, containing only the string username=admin in a cookie, is sufficient to bypass authentication and gain pre-authorization.
> The ntpserver0 parameter accepts user input without validation, enabling injection of system commands like reboot or others.
>
> ------------------------------------------
>
> [Reference]
> https://github.com/actuator/cve/tree/main/Tuoshi
>
> ------------------------------------------
>
> [Discoverer]
> Edward Warren